<!DOCTYPE html>
<html lang="en">

  <head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Controller Design: Schematic &amp; PCBs | Relay Computer</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Controller Design: Schematic &amp; PCBs" />
<meta name="author" content="Paul Law" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In my last couple of posts I finalised the controller schematic designs for the ALU, SETAB, MOV8 and GOTO class of instructions. Now it’s time to bring all those schematics together and design the two controller PCBs. As with the sequencer, the controller is spread over two interconnected cards and I’ll need to decide what’s going on the upper card and what will go on the lower card." />
<meta property="og:description" content="In my last couple of posts I finalised the controller schematic designs for the ALU, SETAB, MOV8 and GOTO class of instructions. Now it’s time to bring all those schematics together and design the two controller PCBs. As with the sequencer, the controller is spread over two interconnected cards and I’ll need to decide what’s going on the upper card and what will go on the lower card." />
<link rel="canonical" href="https://relaycomputer.co.uk/2019/12/controller-design-pcb" />
<meta property="og:url" content="https://relaycomputer.co.uk/2019/12/controller-design-pcb" />
<meta property="og:site_name" content="Relay Computer" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-12-20T03:03:00+00:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Paul Law"},"url":"https://relaycomputer.co.uk/2019/12/controller-design-pcb","description":"In my last couple of posts I finalised the controller schematic designs for the ALU, SETAB, MOV8 and GOTO class of instructions. Now it’s time to bring all those schematics together and design the two controller PCBs. As with the sequencer, the controller is spread over two interconnected cards and I’ll need to decide what’s going on the upper card and what will go on the lower card.","headline":"Controller Design: Schematic &amp; PCBs","@type":"BlogPosting","datePublished":"2019-12-20T03:03:00+00:00","dateModified":"2019-12-20T03:03:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://relaycomputer.co.uk/2019/12/controller-design-pcb"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<!-- Begin CSS Styles -->
<link href="https://fonts.googleapis.com/css?family=PT+Serif:400,500,700" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Lato:300,400,500,700" rel="stylesheet">
<link href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/app.css">
<!-- End CSS Styles -->



<link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/assets/img/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/img/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link type="application/atom+xml" rel="alternate" href="https://relaycomputer.co.uk/feed.xml" title="Relay Computer" />

<!-- Begin EU Cookie Consent -->
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#000"
    },
    "button": {
      "background": "#f1d600"
    }
  }
})});
</script>
<!-- End EU Cookie Consent -->


    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47484999-2', 'auto');
	ga('send', 'pageview', { 'page': location.pathname + location.search + location.hash});
	ga('set', 'anonymizeIp', false);
    </script>
    <!-- End Google Analytics -->
    </head>


  <body>
      <nav class="navbar is-primary" >
        <div class="container">
            <div class="navbar-brand">
                <a href="/" class="navbar-item">
                    Relay Computer
                </a>
                <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu">
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                </a>
            </div>
            <div class="navbar-menu" id="navMenu">
                <div class="navbar-start">
                    <a href="/" class="navbar-item ">Home</a>
                    
                    
                        
                        <a href="/pages/overview.html" class="navbar-item ">Overview</a>
                        
                    
                        
                        <div class="navbar-item has-dropdown is-hoverable">
                            <a href="/#" class="navbar-link ">Summaries</a>
                            <div class="navbar-dropdown">
                                
                                <a href="/pages/progress.html" class="navbar-item ">Progress</a>
                                
                                <a href="/pages/instructions.html" class="navbar-item ">Instructions</a>
                                
                                <a href="/pages/alu.html" class="navbar-item ">ALU</a>
                                
                                <a href="/pages/control.html" class="navbar-item ">Control</a>
                                
                                <a href="/pages/enclosure.html" class="navbar-item ">Enclosure</a>
                                
                                <a href="/pages/registers.html" class="navbar-item ">Registers</a>
                                
                                <a href="/pages/ui.html" class="navbar-item ">UI</a>
                                
                            </div>
                        </div>
                        
                    
                        
                        <a href="/archive.html" class="navbar-item ">Archive</a>
                        
                    
                        
                        <a href="/tags.html" class="navbar-item ">Tags</a>
                        
                    
                    
                </div>
            </div>
        </div>
    </nav>

      
        <section class="hero is-bold is-primary" >
    <div class="hero-body">
        <div class="container">                
            <h1 class="title ">Controller Design: Schematic & PCBs</h1>
            <h2 class="subtitle"></h2>
        </div>
    </div>
</section>
      

      <section class="section">
        <div class="container">
              <div class="columns">
  <div class="column is-three-quarters-widescreen">
    <div class="content">

      <p>In my last couple of posts I finalised the controller schematic designs for the ALU, SETAB, MOV8 and GOTO class of
instructions. Now it’s time to bring all those schematics together and design the two controller PCBs. As with the sequencer,
the controller is spread over two interconnected cards and I’ll need to decide what’s going on the upper card and what will go
on the lower card.</p>

<p>It’s also worth mentioning at this point that the schematics and PCB designs I’m about to share will have some instruction
classes laid out that I haven’t covered yet in this blog. This is because you can’t ‘half design’ a PCB. I’ll cover these
new instructions in more detail in the future but suffice to say that they’ll definitely be needed. In choosing what will go
on which card I follow a similar rule to what I did on the sequencer and go by the number of relays required in each
functional group. In the end I’ve gone for putting GOTO and MOV8/MOV16/MISC on the lower card and everything else on the
upper card.</p>

<p>Schematic wise then it’s just a case of splitting things out and working out which signals will need to be passed between the
cards. Let’s cut to the chase then … you can find the consolidated
<a href="/assets/pdf/controller-hi.pdf">upper controller schematic here</a> and the
<a href="/assets/pdf/controller-lo.pdf">lower controller schematic here</a> (both in PDF format).
In both cases the card is largely defined by the backplane connectors it uses … W1 for the upper card (made up of address, operation and pulse busses) and W2 for the lower card (made up of Control X, Y and Z busses).</p>

<p>For the PCB design we follow the same basic steps as before for the sequencer: place components that have to be in
a certain location first; place other components in rough logical groups; lay tracks; build ground/power planes; add text
labels etc. Again, we’ll also need to pass additional signals between the cards via an ‘interconnect’. Let’s start then
with the backplane connectors as these pre-exist on the W backplane and have to be in a certain location:</p>

<figure><img src="/assets/img/posts/2019/2019-11-11-0000.png" alt="W1 Connectors (Upper Card)" />
  
</figure>

<figure><img src="/assets/img/posts/2019/2019-11-11-0001.png" alt="W2 Connectors (Lower Card)" />
  
</figure>

<p>As before with the sequencer cards the ‘JLCJLCJLCJLC’ text in the top right corner is to let my PCB manufacture know where
I’d like them to put their identification code so they can find my PCB amongst all the others they’ll be making. Again, 
I’ll but it underneath a socket so they can see it but I wont. Next up is the LEDs:</p>

<figure><img src="/assets/img/posts/2019/2019-12-20-0000.png" alt="LEDs (Upper Card)" />
  
</figure>

<figure><img src="/assets/img/posts/2019/2019-12-20-0001.png" alt="LEDs (Lower Card)" />
  
</figure>

<p>It’s not specified on the schematic or the PCB but I’ll stick with my usual convention for LED colours and use
green for selecting registers and yellow for loading registers and other control actions.</p>

<p>I now need to place the relays, diodes and card interconnects. This often involves just moving things around until there’s a
nice fit and the ratlines (showing the connections needed between components) are looking reasonably tidy.</p>

<figure><img src="/assets/img/posts/2019/2019-12-20-0002.png" alt="Basic layout (Upper Card)" />
  
</figure>

<figure><img src="/assets/img/posts/2019/2019-12-20-0003.png" alt="Basic layout (Lower Card)" />
  
</figure>

<p>I’ve also labeled the card now I’ve put everything in position. I find this just helps a little when moving
on to the most time consuming part of PCB design … laying down the tracks. As with my previous cards I’ll stick with the
strategy of laying vertical lines on the front of the card and horizontal lines on the rear. I’m quite tight for room this
time as the boards are fairly densly populated with relays so it took a few attempts to get a routing that worked. Here’s
what I ended up with:</p>

<figure>
  <img src="/assets/img/posts/2019/2019-12-20-0004.png" alt="Upper Card (front)" />
  <img src="/assets/img/posts/2019/2019-12-20-0005.png" alt="Upper Card (rear)" />
  
  <figcaption>Upper Card track routing (front and rear)</figcaption>
</figure>

<figure>
  <img src="/assets/img/posts/2019/2019-12-20-0006.png" alt="Lower Card (front)" />
  <img src="/assets/img/posts/2019/2019-12-20-0007.png" alt="Lower Card (rear)" />
  
  <figcaption>Lower Card track routing (front and rear)</figcaption>
</figure>

<p>Next I add a copper pour on the front and rear of both cards. As before I have a ground plane on both sides
(to ensure ground can get around any areas where there’s a lot of tracks) and then route a ‘power river’ through the rear ground plane.</p>

<p>Finally then I just have a good close up inspection of the board to make sure everything is placed well and tracks are routed
properly. There’s several built-in tools that help with this such as the DRC which’ll check that pad sizes, track widths,
spaces between items and so on are within the abilities of your chosen manufacturer. In my case I’m well away from those
minimum tolerances. Another good idea is to produce a ‘realistic’ image of the final board design to have a last
visual check:</p>

<figure>
  <img src="/assets/img/posts/2019/2019-12-20-0008.png" alt="Upper Card (front)" />
  <img src="/assets/img/posts/2019/2019-12-20-0009.png" alt="Upper Card (rear)" />
  
  <figcaption>Upper Card (front and rear)</figcaption>
</figure>

<figure>
  <img src="/assets/img/posts/2019/2019-12-20-0010.png" alt="Lower Card (front)" />
  <img src="/assets/img/posts/2019/2019-12-20-0011.png" alt="Lower Card (rear)" />
  
  <figcaption>Lower Card (front and rear)</figcaption>
</figure>

<p>If you’d like to take a closer look at any of these you can find the full colour previews in PDF format
<a href="/assets/pdf/controller-hi-pcbp.pdf">here for the upper card</a> and
<a href="/assets/pdf/controller-lo-pcbp.pdf">here for the lower card</a>.
There’s also another version <a href="/assets/pdf/controller-hi-pcb.pdf">here for the upper card</a> and
<a href="/assets/pdf/controller-lo-pcb.pdf">here for the lower card</a> which seperates the layers out.</p>

<p>That’s the controller design fully complete and all I need to do now is send it off to the manufacturer and wait for the
PCBs to arrive in the post.</p>


    </div>

    <div class="field is-grouped is-grouped-multiline">
      <div class="control">
        <a href="/archive#2019" class="tags has-addons">
          <span class="tag is-link">Published</span>
          <span class="tag is-info">Dec 20, 2019</span>
        </a>
      </div>
      
      <div class="control">
        <a href="/tags#control" class="tags">
          <span class="tag is-primary">control</span>
        </a>
      </div>
      
      <div class="control">
        <a href="/tags#design" class="tags">
          <span class="tag is-primary">design</span>
        </a>
      </div>
      
    </div>

    <div class="columns">
      <div class="column">
        
          <span class="has-text-weight-semibold">Previous Post</span><br />
          <a href="/2019/12/controller-alu-mov8-setab-design">Controller Design: ALU, MOV8 & SETAB Instructions</a>
                
      </div>
      <div class="column has-text-right">
        
          <span class="has-text-weight-semibold">Next Post</span><br />
          <a href="/2019/12/controller-construction">Controller Construction</a>
                
      </div>
    </div>

  </div>
</div>
        </div>
      </section>
          
      <footer class="footer">
    <div class="container">
        <div class="columns">
            <div class="column">   
                <h3>On this blog</h3>  
                <p><a href="/index.html">Home</a></p>
                <p><a href="/archive">Archive</a></p>
                <p><a href="/tags">Tags</a></p>
                <p><a href="/pages/progress">Progress</a></p>
            </div>        
            <div class="column">
                <h3>Related sites</h3>
                <p><a href="https://www.youtube.com/channel/UCDn07eKw2HDPIgSAGQgliAA"><span class="fab fa-youtube fa-lg fa-fw"></span> YouTube Channel</a></p>
                <p><a href="https://github.com/paul80nd"><span class="fab fa-github fa-lg fa-fw"></span> GitHub Repos</a></p>
                <p><a href="http://simulator.relaycomputer.co.uk"><span class="fas fa-flask fa-lg fa-fw"></span> Relay Simulator</a></p>
            </div>
            <div class="column">
                <h3>Share on social media</h3>
                <p><a href="https://www.facebook.com/sharer/sharer.php?u=&amp;quote=" target="_blank"><span class="fab fa-facebook fa-lg fa-fw"></span> Share on Facebook</a></p>
                <p><a href="https://twitter.com/intent/tweet?source=&amp;text=" target="_blank"><span class="fab fa-twitter fa-lg fa-fw"></span> Tweet</a></p>
                <p><a href="http://www.tumblr.com/share?v=3&amp;u=&amp;quote=&amp;s=" target="_blank"><span class="fab fa-tumblr fa-lg fa-fw"></span> Post to Tumblr</a></p> 
                <p><a href="http://pinterest.com/pin/create/button/?url=&amp;description=" target="_blank"><span class="fab fa-pinterest fa-lg fa-fw"></span> Pin it</a></p> 
                <p><a href="http://www.reddit.com/submit?url=&amp;title=" target="_blank"><span class="fab fa-reddit fa-lg fa-fw"></span> Submit to Reddit</a></p>   
                <p><a href="mailto:?subject=&amp;body=" target="_blank"><span class="fas fa-envelope fa-lg fa-fw"></span> Send email</a></p> 
            </div>
        </div>                    
    </div>
</footer>

      <script src="/assets/js/app.js" type="text/javascript"></script>
  </body>

</html>