<!DOCTYPE html>
<html lang="en">

  <head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Sequencer Design: 24-cycle FSM | Relay Computer</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Sequencer Design: 24-cycle FSM" />
<meta name="author" content="Paul Law" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Recently I’ve been looking at what’s needed to implement branching in my computer (the upcoming GOTO class of instructions). In my last post I covered the timing chart for the GOTO class which is repeated below:" />
<meta property="og:description" content="Recently I’ve been looking at what’s needed to implement branching in my computer (the upcoming GOTO class of instructions). In my last post I covered the timing chart for the GOTO class which is repeated below:" />
<link rel="canonical" href="https://relaycomputer.co.uk/2019/11/sequencer-design-24-cycle-fsm" />
<meta property="og:url" content="https://relaycomputer.co.uk/2019/11/sequencer-design-24-cycle-fsm" />
<meta property="og:site_name" content="Relay Computer" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-11-01T03:03:00+00:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Paul Law"},"url":"https://relaycomputer.co.uk/2019/11/sequencer-design-24-cycle-fsm","description":"Recently I’ve been looking at what’s needed to implement branching in my computer (the upcoming GOTO class of instructions). In my last post I covered the timing chart for the GOTO class which is repeated below:","headline":"Sequencer Design: 24-cycle FSM","@type":"BlogPosting","datePublished":"2019-11-01T03:03:00+00:00","dateModified":"2019-11-01T03:03:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://relaycomputer.co.uk/2019/11/sequencer-design-24-cycle-fsm"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<!-- Begin CSS Styles -->
<link href="https://fonts.googleapis.com/css?family=PT+Serif:400,500,700" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Lato:300,400,500,700" rel="stylesheet">
<link href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/app.css">
<!-- End CSS Styles -->



<link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/assets/img/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/img/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link type="application/atom+xml" rel="alternate" href="https://relaycomputer.co.uk/feed.xml" title="Relay Computer" />

<!-- Begin EU Cookie Consent -->
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#000"
    },
    "button": {
      "background": "#f1d600"
    }
  }
})});
</script>
<!-- End EU Cookie Consent -->


    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47484999-2', 'auto');
	ga('send', 'pageview', { 'page': location.pathname + location.search + location.hash});
	ga('set', 'anonymizeIp', false);
    </script>
    <!-- End Google Analytics -->
    </head>


  <body>
      <nav class="navbar is-primary" >
        <div class="container">
            <div class="navbar-brand">
                <a href="/" class="navbar-item">
                    Relay Computer
                </a>
                <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu">
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                </a>
            </div>
            <div class="navbar-menu" id="navMenu">
                <div class="navbar-start">
                    <a href="/" class="navbar-item ">Home</a>
                    
                    
                        
                        <a href="/pages/overview.html" class="navbar-item ">Overview</a>
                        
                    
                        
                        <div class="navbar-item has-dropdown is-hoverable">
                            <a href="/#" class="navbar-link ">Summaries</a>
                            <div class="navbar-dropdown">
                                
                                <a href="/pages/progress.html" class="navbar-item ">Progress</a>
                                
                                <a href="/pages/instructions.html" class="navbar-item ">Instructions</a>
                                
                                <a href="/pages/alu.html" class="navbar-item ">ALU</a>
                                
                                <a href="/pages/control.html" class="navbar-item ">Control</a>
                                
                                <a href="/pages/enclosure.html" class="navbar-item ">Enclosure</a>
                                
                                <a href="/pages/registers.html" class="navbar-item ">Registers</a>
                                
                                <a href="/pages/ui.html" class="navbar-item ">UI</a>
                                
                            </div>
                        </div>
                        
                    
                        
                        <a href="/archive.html" class="navbar-item ">Archive</a>
                        
                    
                        
                        <a href="/tags.html" class="navbar-item ">Tags</a>
                        
                    
                    
                </div>
            </div>
        </div>
    </nav>

      
        <section class="hero is-bold is-primary" >
    <div class="hero-body">
        <div class="container">                
            <h1 class="title ">Sequencer Design: 24-cycle FSM</h1>
            <h2 class="subtitle"></h2>
        </div>
    </div>
</section>
      

      <section class="section">
        <div class="container">
              <div class="columns">
  <div class="column is-three-quarters-widescreen">
    <div class="content">

      <p>Recently I’ve been looking at what’s needed to implement branching in my computer (the upcoming GOTO class of instructions).
In my last post I covered the timing chart for the GOTO class which is repeated below:</p>

<figure><img src="/assets/img/posts/2019/2019-10-06-0004.png" alt="GOTO opcode timing chart" />
  
  <figcaption>GOTO opcode timing chart (<a href="/assets/img/posts/2019/2019-10-06-1004.png">larger</a>)</figcaption>
</figure>

<p>To achieve this timing I’ll need a sequencer that can ‘count’ up to 24 (currently it only goes up to 8). Actually none of this
is too difficult as counting beyond 8 more-or-less repeats the same pattern of relays. If you’re not familiar with how the
current 8 cycle sequencer works then it’s well worth reading
<a href="/2015/01/sequencer-design-8-cycle-fsm">the post on that</a>
which goes in to more detail around how the FSM (finite state machine) works.</p>

<p>As mentioned I’ve already got an 8-cycle sequencer which is built using wire-wrap, sockets and the matrix boards. Given I’ve
already taken the leap in using professionally manufactured PCBs now I’ll follow suit here and re-design the full sequencer
from scratch. Transferring the existing 8-cycle design in to EasyEDA we get the following:</p>

<figure><img src="/assets/img/posts/2019/2019-11-01-0000.png" alt="8-cycle FSM" />
  
</figure>

<p>I’ll add a link later in this post to a nice PDF version of these diagrams so you can take a closer look should you wish to.
Note though that this is the exact same circuit as before … it’s just laid out differently. To keep the diagram cleaner I’ve
put the clock divider at the top left and the abort-8 relay at the bottom left. You can then see the main ring counter is to
the right. Note that the abort-8 latch is there to interupt the FSM chain when needed … if the latch isn’t set then the
counter continues on to 10-cycles and 12-cycles as follows:</p>

<figure><img src="/assets/img/posts/2019/2019-11-01-0001.png" alt="10/12-cycle FSM" />
  
</figure>

<p>So, this is another 4 stages of the ring counter with abort relays at the 10 and 12 cycle mark. Similarly we can add another
4 stages to get to the 16 cycle mark:</p>

<figure><img src="/assets/img/posts/2019/2019-11-01-0002.png" alt="14-cycle FSM" />
  
</figure>

<p>Here we’re adding an abort relay at stage 14. These aborts at 8/10/12/14-cycles aren’t placed arbitrarily of course … these
are the exact lengths of the various instruction classes I’ll be implementing in the computer. So far we only have 8-cycle
instructions implemented but there will be 10, 12 and 14 cycle ones coming up.</p>

<p>All that remains to do then is repeat the ring counter pattern all the way up to 24 cycles:</p>

<figure><img src="/assets/img/posts/2019/2019-11-01-0003.png" alt="24-cycle FSM" />
  
</figure>

<p>Note that no abort relay is required in this portion of the FSM as at the end of the chain we just active the RESET line
directly which will restart the sequencer back from stage 0.</p>

<p>As mentioned above you can find a <a href="/assets/img/posts/2019/2019-11-01-1003.pdf">PDF version of these schematics here</a>.</p>

<p>So, that gives us something that can count to 24 but how does that help us get the timing pulses for the GOTO instruction?
Well, lets take a look at the outputs of the 24-cycle FSM:</p>

<figure><img src="/assets/img/posts/2019/2019-11-01-0004.png" alt="24-cycle FSM Outputs" />
  
  <figcaption>24-cycle FSM Outputs (<a href="/assets/pdf/sequencer-timing.pdf">larger</a>)</figcaption>
</figure>

<p>You might be able to spot that some of the outputs are exactly what we’re looking for … they’re the right pulse for the
right duration of time. Some of the pulses we need though can be obtained by combining the outputs together. This is what I
call ‘pulse distribution’ and I’ll cover that off in my next post … and combining the FSM with the pulse distribution
gives us the sequencer as a complete unit.</p>


    </div>

    <div class="field is-grouped is-grouped-multiline">
      <div class="control">
        <a href="/archive#2019" class="tags has-addons">
          <span class="tag is-link">Published</span>
          <span class="tag is-info">Nov 1, 2019</span>
        </a>
      </div>
      
      <div class="control">
        <a href="/tags#sequencing" class="tags">
          <span class="tag is-primary">sequencing</span>
        </a>
      </div>
      
      <div class="control">
        <a href="/tags#design" class="tags">
          <span class="tag is-primary">design</span>
        </a>
      </div>
      
    </div>

    <div class="columns">
      <div class="column">
        
          <span class="has-text-weight-semibold">Previous Post</span><br />
          <a href="/2019/10/branching-opcode-timing">Branching: Opcode Timing</a>
                
      </div>
      <div class="column has-text-right">
        
          <span class="has-text-weight-semibold">Next Post</span><br />
          <a href="/2019/11/sequencer-design-pulse-dist">Sequencer Design: Pulse Distribution</a>
                
      </div>
    </div>

  </div>
</div>
        </div>
      </section>
          
      <footer class="footer">
    <div class="container">
        <div class="columns">
            <div class="column">   
                <h3>On this blog</h3>  
                <p><a href="/index.html">Home</a></p>
                <p><a href="/archive">Archive</a></p>
                <p><a href="/tags">Tags</a></p>
                <p><a href="/pages/progress">Progress</a></p>
            </div>        
            <div class="column">
                <h3>Related sites</h3>
                <p><a href="https://www.youtube.com/channel/UCDn07eKw2HDPIgSAGQgliAA"><span class="fab fa-youtube fa-lg fa-fw"></span> YouTube Channel</a></p>
                <p><a href="https://github.com/paul80nd"><span class="fab fa-github fa-lg fa-fw"></span> GitHub Repos</a></p>
                <p><a href="http://simulator.relaycomputer.co.uk"><span class="fas fa-flask fa-lg fa-fw"></span> Relay Simulator</a></p>
            </div>
            <div class="column">
                <h3>Share on social media</h3>
                <p><a href="https://www.facebook.com/sharer/sharer.php?u=&amp;quote=" target="_blank"><span class="fab fa-facebook fa-lg fa-fw"></span> Share on Facebook</a></p>
                <p><a href="https://twitter.com/intent/tweet?source=&amp;text=" target="_blank"><span class="fab fa-twitter fa-lg fa-fw"></span> Tweet</a></p>
                <p><a href="http://www.tumblr.com/share?v=3&amp;u=&amp;quote=&amp;s=" target="_blank"><span class="fab fa-tumblr fa-lg fa-fw"></span> Post to Tumblr</a></p> 
                <p><a href="http://pinterest.com/pin/create/button/?url=&amp;description=" target="_blank"><span class="fab fa-pinterest fa-lg fa-fw"></span> Pin it</a></p> 
                <p><a href="http://www.reddit.com/submit?url=&amp;title=" target="_blank"><span class="fab fa-reddit fa-lg fa-fw"></span> Submit to Reddit</a></p>   
                <p><a href="mailto:?subject=&amp;body=" target="_blank"><span class="fas fa-envelope fa-lg fa-fw"></span> Send email</a></p> 
            </div>
        </div>                    
    </div>
</footer>

      <script src="/assets/js/app.js" type="text/javascript"></script>
  </body>

</html>