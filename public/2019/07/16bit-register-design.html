<!DOCTYPE html>
<html lang="en">

  <head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>16-bit Register Design | Relay Computer</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="16-bit Register Design" />
<meta name="author" content="Paul Law" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In my last couple of posts I’ve been building up to a change of approach in how I’m making the cards in my computer. This is mainly because I can’t face the monotony of hand building the upcoming register cards (which I’ll need three of so it’s triple the procrastination holding me back). The obvious solution to all of this is to create a Printed Circuit Board (PCB) which will cut out most of the trickier soldering and pretty much all the repetitive wirewrap … and that looked like the way to go until I had a go at hand crafting a simplified PCB for the Y backplane and I realised it’s not as easy as it might otherwise appear." />
<meta property="og:description" content="In my last couple of posts I’ve been building up to a change of approach in how I’m making the cards in my computer. This is mainly because I can’t face the monotony of hand building the upcoming register cards (which I’ll need three of so it’s triple the procrastination holding me back). The obvious solution to all of this is to create a Printed Circuit Board (PCB) which will cut out most of the trickier soldering and pretty much all the repetitive wirewrap … and that looked like the way to go until I had a go at hand crafting a simplified PCB for the Y backplane and I realised it’s not as easy as it might otherwise appear." />
<link rel="canonical" href="https://relaycomputer.co.uk/2019/07/16bit-register-design" />
<meta property="og:url" content="https://relaycomputer.co.uk/2019/07/16bit-register-design" />
<meta property="og:site_name" content="Relay Computer" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-07-15T12:00:00+01:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Paul Law"},"url":"https://relaycomputer.co.uk/2019/07/16bit-register-design","description":"In my last couple of posts I’ve been building up to a change of approach in how I’m making the cards in my computer. This is mainly because I can’t face the monotony of hand building the upcoming register cards (which I’ll need three of so it’s triple the procrastination holding me back). The obvious solution to all of this is to create a Printed Circuit Board (PCB) which will cut out most of the trickier soldering and pretty much all the repetitive wirewrap … and that looked like the way to go until I had a go at hand crafting a simplified PCB for the Y backplane and I realised it’s not as easy as it might otherwise appear.","headline":"16-bit Register Design","@type":"BlogPosting","datePublished":"2019-07-15T12:00:00+01:00","dateModified":"2019-07-15T12:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://relaycomputer.co.uk/2019/07/16bit-register-design"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<!-- Begin CSS Styles -->
<link href="https://fonts.googleapis.com/css?family=PT+Serif:400,500,700" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Lato:300,400,500,700" rel="stylesheet">
<link href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/app.css">
<!-- End CSS Styles -->



<link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/assets/img/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/img/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link type="application/atom+xml" rel="alternate" href="https://relaycomputer.co.uk/feed.xml" title="Relay Computer" />

<!-- Begin EU Cookie Consent -->
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#000"
    },
    "button": {
      "background": "#f1d600"
    }
  }
})});
</script>
<!-- End EU Cookie Consent -->


    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47484999-2', 'auto');
	ga('send', 'pageview', { 'page': location.pathname + location.search + location.hash});
	ga('set', 'anonymizeIp', false);
    </script>
    <!-- End Google Analytics -->
    </head>


  <body>
      <nav class="navbar is-primary" >
        <div class="container">
            <div class="navbar-brand">
                <a href="/" class="navbar-item">
                    Relay Computer
                </a>
                <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu">
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                    <span aria-hidden="true"></span>
                </a>
            </div>
            <div class="navbar-menu" id="navMenu">
                <div class="navbar-start">
                    <a href="/" class="navbar-item ">Home</a>
                    
                    
                        
                        <a href="/pages/overview.html" class="navbar-item ">Overview</a>
                        
                    
                        
                        <div class="navbar-item has-dropdown is-hoverable">
                            <a href="/#" class="navbar-link ">Summaries</a>
                            <div class="navbar-dropdown">
                                
                                <a href="/pages/progress.html" class="navbar-item ">Progress</a>
                                
                                <a href="/pages/instructions.html" class="navbar-item ">Instructions</a>
                                
                                <a href="/pages/alu.html" class="navbar-item ">ALU</a>
                                
                                <a href="/pages/control.html" class="navbar-item ">Control</a>
                                
                                <a href="/pages/enclosure.html" class="navbar-item ">Enclosure</a>
                                
                                <a href="/pages/registers.html" class="navbar-item ">Registers</a>
                                
                                <a href="/pages/ui.html" class="navbar-item ">UI</a>
                                
                            </div>
                        </div>
                        
                    
                        
                        <a href="/archive.html" class="navbar-item ">Archive</a>
                        
                    
                        
                        <a href="/tags.html" class="navbar-item ">Tags</a>
                        
                    
                    
                </div>
            </div>
        </div>
    </nav>

      
        <section class="hero is-bold is-primary" >
    <div class="hero-body">
        <div class="container">                
            <h1 class="title ">16-bit Register Design</h1>
            <h2 class="subtitle"></h2>
        </div>
    </div>
</section>
      

      <section class="section">
        <div class="container">
              <div class="columns">
  <div class="column is-three-quarters-widescreen">
    <div class="content">

      <p>In my last couple of posts I’ve been building up to a change of approach in how I’m making the cards in my
computer. This is mainly because I can’t face the monotony of hand building the upcoming register cards (which
I’ll need three of so it’s triple the procrastination holding me back). The obvious solution to all of this is
to create a Printed Circuit Board (PCB) which will cut out most of the trickier soldering and pretty much all
the repetitive wirewrap … and that looked like the way to go until I had a go at hand crafting a simplified
PCB for the Y backplane and I realised it’s not as easy as it might otherwise appear.</p>

<p>Well OK, yes, the Y backplane did work but not without a lot of tweaks and repairs and that was just a simple single
sided PCB. The registers boards are far more complicated and there’s no way I can design a single sided board
without having lots of lines crossing over each other. The ‘fix’ here is to make a double sided PCB with tracks on
both sides and with vias (tiny solder filled holes) passing the signals/line from front to back etc. I did a few
rough drafts on paper to get a feel for how the board would look and what lines would need to go where but it soon
dawned on me that I’d end up with more work than my original approach and with likely more mistakes and problems.</p>

<p>So, what to do then? Well it seems that maybe it’s time to wave my little white flag, accept some level of defeat and
hand the hard work over to the ‘big boys’. That’s right, I’ll farm out the manufacturing of the PCB to a professional
outfit who can do a decent job. In some ways this feels a little bit like ‘cheating’ although it wouldn’t be the first
time I’ve taken a shortcut (using a modern memory chip rather than a house full of relays for example). I’ve kind of
convinced myself that getting someone else to make my PCBs is acceptable though as I’m not setting out to prove I can
make a computer from the most basic of ingredients just to make a computer that works, has some connection with the
original relay computers and ultimately is enjoyable to build (this is a hobby project after all).</p>

<p>There’s quite a bit of choice when it comes to picking a PCB manufacturing house but after several recommendations I’ve
gone with <a rel="nofollow" href="https://jlcpcb.com">JLCPCB</a>. Although there’s a minimum order quantity of 5 (which works out quite well for my
register cards) the per-board card is impressively cheap but even more impressive is that they have a free design software
offering <a rel="nofollow" href="https://easyeda.com">EasyEDA</a> which makes it easy to design your PCBs. Yea, I guess there’s a bit of vendor lock-in
here perhaps but it looks like you can export to other file formats and there’s a native Mac client which pretty much had
me sold.</p>

<p>So, a fair bit of preamble there then but that gets me to the point where I’m now ready to design a register card in EasyEDA.
My goal is to design a card that has two 8-bit registers that read and write from/to the data bus (much like the registers
built so far) but that can also be paired up in to a 16-bit register that gates to/from the address bus. Looking back to the design of the 8-bit A/D register we ended up with this:</p>

<figure><img src="/assets/img/posts/2014/2014-04-20-0004.png" alt="Complete AD Register" />
  
  <figcaption>Complete AD Register (<a href="/assets/img/posts/2014/2014-04-20-1004.png">larger</a>)</figcaption>
</figure>

<p>This schematic was produced in OmniGraffle on my Mac and is, to all intents and purposes, just a picture. What makes EasyEDA
such a leap forward is that doing the schematic design in that captures what the components actually are and how they connect
to each other. This makes it easy to produce lists of parts and ultimately to transform the schematic into a PCB. Anyho, I’m
getting ahead of myself. I need to reproduce the OmniGraffle design in EasyEDA … let’s start with the most basic element …
a 1-bit register unit:</p>

<figure><img src="/assets/img/posts/2019/2019-07-15-0000.png" alt="1-bit Register Unit" />
  
</figure>

<p>R0 in the schematic is the input/output to the unit. Supplying power to this line activates the relay and then as long as
power is supplied to the Hold line that relay will be kept activated. Dropping the Hold line resets the relay. All the
basic functionality is handled on the right hand side of the relay. The left hand side allows a LED to display the current
state of the register bit without complicating the primary circuitry on the right. As always there’s a flyback diode over the
relay coil to absorb the spike when the relay is deactivated.</p>

<p>From this basic 1-bit register design it’s fairly trivial to connect eight units together to make an 8-bit register:</p>

<figure><img src="/assets/img/posts/2019/2019-07-15-0001.png" alt="8-bit Register Unit" />
  
  <figcaption>8-bit Register Unit (<a href="/assets/img/posts/2019/2019-07-15-1001.png">larger</a>)</figcaption>
</figure>

<p>Note that the Hold line is shared across all the relay ‘bits’ so that the register can be held/cleared as one but that each
individual ‘bit’ has its own input/output line R0-R7. To get two 8-bit registers we just double up the design:</p>

<figure><img src="/assets/img/posts/2019/2019-07-15-0002.png" alt="2 x 8-bit Register Units" />
  
  <figcaption>2 x 8-bit Register Units (<a href="/assets/img/posts/2019/2019-07-15-1002.png">larger</a>)</figcaption>
</figure>

<p>The data input/output lines continue on from R8 thru RF but note that the hold line is different. The first 8-bits use a HoldL line and the next 8-bits use a HoldH line. This refers to High and Low hold lines which allows either the high (R8-RF)
or low (R0-R7) register to be held or cleared as required. Effectively each 8-bit register can be loaded/cleared independently
as and where required. We’ll come back to the control circuitry that drives this in a bit but let’s look at the bus gating
next:</p>

<figure><img src="/assets/img/posts/2019/2019-07-15-0003.png" alt="1-bit Gating" />
  
</figure>

<p>In this case we’re looking at the gating for register bits R6 and R7 (the highest bits of the low 8-bit register). R6 and R7
connect to the register bits in the schematics above and the gating relays allow that input/output line to be gated to either
D6 and D7 of the data bus or A6 and A7 of the address bus. EnL enables the gating to the data bus and the line at the bottom
of this schematic (EnHL) gates to the address bus. Again, we can extend this design out to gate a full 8-bit register:</p>

<figure><img src="/assets/img/posts/2019/2019-07-15-0004.png" alt="8-bit Gating" />
  
  <figcaption>8-bit Gating (<a href="/assets/img/posts/2019/2019-07-15-1004.png">larger</a>)</figcaption>
</figure>

<p>… and onwards to gate the two 8-bit registers as independant units or together as a single 16-bit register …</p>

<figure><img src="/assets/img/posts/2019/2019-07-15-0005.png" alt="2 x 8-bit Gating" />
  
  <figcaption>2 x 8-bit Gating (<a href="/assets/img/posts/2019/2019-07-15-1005.png">larger</a>)</figcaption>
</figure>

<p>Note that EnL (lower 8-bit register) gates R0 - R7 to D0 - D7, as you’d expect, but EnH (upper 8-bit register) gates R8 - RF also to D0 - D7. This makes sense because there’s only one 8-bit data bus and if you wanted to load the full 16-bit register
from there you’d need to load the lower 8-bits first and then the upper 8-bits. Of course, there only needs to be one EnHL for
the 16-bit address bus which gates A0-AF to R0-RF. Right, that’s the register relays and the gating … let’s return to the
control circuitry:</p>

<figure><img src="/assets/img/posts/2019/2019-07-15-0006.png" alt="Low Register Control" />
  
</figure>

<p>This handles the HoldL and EnL lines we’ve already seen for the lower 8-bit register. The inputs to this circuit are SelL to
write to the data bus and LdL to load from the data bus. Selecting the register to write to the data bus is very easy … we
just activate the gating relays. Load is a bit more involved however. To load we need to disconnect the hold line (which
clears any value held in the lower register) but also we need to activate the gating relays to bring in the value on the data
bus. Interestingly here the HoldL comes in from HoldHL and this is so that by default both 8-bit registers are holding their
value and if we want to load one independently we need to veto that hold. If both registers are being loaded together then the
HoldHL line is dropped which achieves the same as far as holding is concerned. We can now repeat this design as you’d expect:</p>

<figure><img src="/assets/img/posts/2019/2019-07-15-0007.png" alt="Register Control" />
  
  <figcaption>Register Control (<a href="/assets/img/posts/2019/2019-07-15-1007.png">larger</a>)</figcaption>
</figure>

<p>So that gives us the three main components of a register: storage bits, gating and control. We finally need a way to connect
the register to the outside World and that’s where the card connectors come in. In the schematic they’re represented as
follows:</p>

<figure><img src="/assets/img/posts/2019/2019-07-15-0008.png" alt="Card Connectors" />
  
  <figcaption>Card Connectors (<a href="/assets/img/posts/2019/2019-07-15-1008.png">larger</a>)</figcaption>
</figure>

<p>This now brings us to one final minor problem. I want to make three 16-bit register cards however there’s something stopping
them from being created identically. The three registers will be M (M1 and M2), J (J1 and J2) and XY (X and Y). The difference
here is that each will respond to different control signals to ensure that if you’re loading, say, the lower 8-bit M1 register
you don’t impact to lower 8-bit X register. I need some way of ‘configuring’ each register card to make it M, J or XY
specific. The simplest solution here is to have a jumper block that I can set a wirewrap link on:</p>

<figure><img src="/assets/img/posts/2019/2019-07-15-0009.png" alt="Configuration Jumpers" />
  
</figure>

<p>… and with that we have a complete design for a 16-bit register with independently controllable upper and lower 8-bit
‘sub-registers’. As usual there’s a version of the full design <a href="/assets/pdf/register-jmxy.pdf">here in PDF format</a>. In my next post I’ll go through how this schematic becomes a PCB design that can be sent off to JLCPCB for manufacturing.</p>


    </div>

    <div class="field is-grouped is-grouped-multiline">
      <div class="control">
        <a href="/archive#2019" class="tags has-addons">
          <span class="tag is-link">Published</span>
          <span class="tag is-info">Jul 15, 2019</span>
        </a>
      </div>
      
      <div class="control">
        <a href="/tags#design" class="tags">
          <span class="tag is-primary">design</span>
        </a>
      </div>
      
      <div class="control">
        <a href="/tags#registers" class="tags">
          <span class="tag is-primary">registers</span>
        </a>
      </div>
      
    </div>

    <div class="columns">
      <div class="column">
        
          <span class="has-text-weight-semibold">Previous Post</span><br />
          <a href="/2019/03/making-a-pcb">Making a PCB</a>
                
      </div>
      <div class="column has-text-right">
        
          <span class="has-text-weight-semibold">Next Post</span><br />
          <a href="/2019/08/16bit-register-pcb-design">16-bit Register PCB Design</a>
                
      </div>
    </div>

  </div>
</div>
        </div>
      </section>
          
      <footer class="footer">
    <div class="container">
        <div class="columns">
            <div class="column">   
                <h3>On this blog</h3>  
                <p><a href="/index.html">Home</a></p>
                <p><a href="/archive">Archive</a></p>
                <p><a href="/tags">Tags</a></p>
                <p><a href="/pages/progress">Progress</a></p>
            </div>        
            <div class="column">
                <h3>Related sites</h3>
                <p><a href="https://www.youtube.com/channel/UCDn07eKw2HDPIgSAGQgliAA"><span class="fab fa-youtube fa-lg fa-fw"></span> YouTube Channel</a></p>
                <p><a href="https://github.com/paul80nd"><span class="fab fa-github fa-lg fa-fw"></span> GitHub Repos</a></p>
                <p><a href="http://simulator.relaycomputer.co.uk"><span class="fas fa-flask fa-lg fa-fw"></span> Relay Simulator</a></p>
            </div>
            <div class="column">
                <h3>Share on social media</h3>
                <p><a href="https://www.facebook.com/sharer/sharer.php?u=&amp;quote=" target="_blank"><span class="fab fa-facebook fa-lg fa-fw"></span> Share on Facebook</a></p>
                <p><a href="https://twitter.com/intent/tweet?source=&amp;text=" target="_blank"><span class="fab fa-twitter fa-lg fa-fw"></span> Tweet</a></p>
                <p><a href="http://www.tumblr.com/share?v=3&amp;u=&amp;quote=&amp;s=" target="_blank"><span class="fab fa-tumblr fa-lg fa-fw"></span> Post to Tumblr</a></p> 
                <p><a href="http://pinterest.com/pin/create/button/?url=&amp;description=" target="_blank"><span class="fab fa-pinterest fa-lg fa-fw"></span> Pin it</a></p> 
                <p><a href="http://www.reddit.com/submit?url=&amp;title=" target="_blank"><span class="fab fa-reddit fa-lg fa-fw"></span> Submit to Reddit</a></p>   
                <p><a href="mailto:?subject=&amp;body=" target="_blank"><span class="fas fa-envelope fa-lg fa-fw"></span> Send email</a></p> 
            </div>
        </div>                    
    </div>
</footer>

      <script src="/assets/js/app.js" type="text/javascript"></script>
  </body>

</html>